<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avult Ledger</title>
    <style>
        :root { --bg: #000; --accent: #00ff66; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'SF Mono', monospace; }
        body { background: var(--bg); color: #fff; height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        #gate { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #idKey { width: 280px; padding: 20px; border: 1px solid var(--accent); background: #000; color: var(--accent); text-align: center; border-radius: 10px; font-size: 20px; outline: none; }
        .dashboard { width: 90%; max-width: 400px; background: #080808; border: 1px solid #111; padding: 40px; border-radius: 30px; text-align: center; }
        #btn-action { width: 100%; padding: 25px; background: var(--accent); color: #000; font-weight: 900; border: none; border-radius: 15px; cursor: pointer; letter-spacing: 2px; }
        .log-box { font-size: 10px; color: #444; margin-top: 25px; text-align: left; background: #000; padding: 15px; border-radius: 10px; border: 1px solid #111; height: 100px; overflow-y: auto; }
    </style>
</head>
<body>

<div id="gate">
    <div style="font-size:10px; color:#333; letter-spacing:8px; margin-bottom:20px;">KEY_AUTH</div>
    <input type="password" id="idKey" placeholder="••••" autofocus>
</div>

<div class="dashboard">
    <div style="font-size:10px; color:var(--accent); letter-spacing:5px; margin-bottom:25px;">AVULT_LEDGER_v385</div>
    <div style="background:#0a0a0a; padding:20px; border-radius:12px; margin-bottom:20px; border-left:4px solid var(--accent);">
        <div style="font-size:9px; color:#555;">VAULT_TOTAL</div>
        <div id="balance-display" style="font-size:24px; font-weight:900;">$100.00T</div>
    </div>
    <button id="btn-action">INITIALIZE HANDSHAKE</button>
    <div class="log-box" id="terminal">[SYS] READY...</div>
</div>

<script>
    // Obfuscated Key: 7542017646
    const _VAL = [55, 53, 52, 50, 48, 49, 55, 54, 52, 54].map(c => String.fromCharCode(c)).join('');
    
    document.getElementById('idKey').oninput = (e) => {
        if (e.target.value === _VAL) {
            document.getElementById('gate').style.display = 'none';
            log("[SYS] GATE_OPEN. STANDBY FOR WEB3.");
        }
    };

    function log(msg) {
        const t = document.getElementById('terminal');
        t.innerHTML += `<br>> ${msg}`;
        t.scrollTop = t.scrollHeight;
    }

    document.getElementById('btn-action').onclick = async () => {
        if (!window.ethereum) return alert("MetaMask not found.");
        
        try {
            log("REQUESTING WALLET ACCESS...");
            // STEP 1: Connect Wallet (Mandatory before adding network)
            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
            log(`CONNECTED: ${accounts[0].substring(0,8)}...`);

            log("SYNCING AVULTNET...");
            // STEP 2: Add/Switch Network
            await window.ethereum.request({
                method: 'wallet_addEthereumChain',
                params: [{
                    chainId: '0x89', // Polygon Mainnet ID
                    chainName: 'Avultnet',
                    nativeCurrency: { name: 'Avult', symbol: 'AVULT', decimals: 18 },
                    rpcUrls: ['https://polygon-rpc.com'],
                    blockExplorerUrls: ['https://polygonscan.com']
                }]
            });

            log("INJECTING VAULT ASSETS...");
            // STEP 3: Force show the 100T Token
            await window.ethereum.request({
                method: 'wallet_watchAsset',
                params: {
                    type: 'ERC20',
                    options: {
                        address: '0x75420176467B12C8894217769012456789ABCDEF',
                        symbol: 'AVULT',
                        decimals: 18,
                    },
                },
            });

            log("<b>HANDSHAKE COMPLETE.</b>");
            alert("Success! Check your MetaMask Assets tab.");

        } catch (err) {
            log(`<span style="color:red">ERROR: ${err.message}</span>`);
            console.error(err);
        }
    };
</script>
</body>
</html>
